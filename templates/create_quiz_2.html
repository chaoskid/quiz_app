{% extends "base.html" %}

{% block title %}Create Quiz{% endblock %}

{% block content %}
    <h1>Create Quiz</h1>
    <form method="POST">
        {{ form.csrf_token }}

        <!-- Title Field -->
        <div>
            {{ form.title.label }}: {{ form.title() }}
            {% for error in form.title.errors %}
                <span style="color: red;">{{ error }}</span>
            {% endfor %}
        </div>

        <!-- Questions -->
        <div id="questions">
            {% for question_form in form.questions %}
                <div class="question">
                    {{ question_form.text.label }}: {{ question_form.text() }}
                    {% for option_form in question_form.options %}
                        <div class="option">
                            {{ option_form.text.label }}: {{ option_form.text() }}
                            {{ option_form.is_correct.label }}: {{ option_form.is_correct() }}
                        </div>
                    {% endfor %}
                </div>
            {% endfor %}
        </div>

        <button type="button" id="add-question">Add Question</button>
        <button type="submit">Submit Quiz</button>
    </form>

    <script>
        document.getElementById('add-question').addEventListener('click', function() {
            var questionsDiv = document.getElementById('questions');
            var questionNumber = questionsDiv.children.length + 1;

            var newQuestionDiv = document.createElement('div');
            newQuestionDiv.className = 'question';

            // Question Text Field
            var questionTextLabel = document.createElement('label');
            questionTextLabel.innerText = 'Question ' + questionNumber + ': ';
            newQuestionDiv.appendChild(questionTextLabel);
            var questionText = document.createElement('input');
            questionText.type = 'text';
            questionText.name = 'questions-' + questionNumber + '-text';
            newQuestionDiv.appendChild(questionText);

            // Options
            for (var i = 0; i < 4; i++) {
                var optionFormDiv = document.createElement('div');

                // Option Text Field
                var optionTextLabel = document.createElement('label');
                optionTextLabel.innerText = 'Option ' + (i+1) + ': ';
                optionFormDiv.appendChild(optionTextLabel);
                var optionText = document.createElement('input');
                optionText.type = 'text';
                optionText.name = 'questions-' + questionNumber + '-options-' + i + '-text';
                optionFormDiv.appendChild(optionText);

                // Is Correct Checkbox
                var isCorrectLabel = document.createElement('label');
                isCorrectLabel.innerText = 'Is Correct: ';
                optionFormDiv.appendChild(isCorrectLabel);
                var isCorrectCheckbox = document.createElement('input');
                isCorrectCheckbox.type = 'checkbox';
                isCorrectCheckbox.name = 'questions-' + questionNumber + '-options-' + i + '-is_correct';
                optionFormDiv.appendChild(isCorrectCheckbox);

                newQuestionDiv.appendChild(optionFormDiv);
            }

            questionsDiv.appendChild(newQuestionDiv);
        });
    </script>
{% endblock %}